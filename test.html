<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gemini API Key Tester</title>
    <!-- Using Tailwind CSS for a clean, modern design -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Custom styles for the body and fonts */
      body {
        font-family: "Inter", sans-serif;
        background-color: #f3f4f6; /* A light gray background */
      }
      /* Style for the loading spinner */
      .loader {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3498db;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body class="flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-2xl mx-4">
      <!-- Header Section -->
      <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">Gemini API Key Tester</h1>
        <p class="text-gray-500 mt-2">
          Instantly test your Google Gemini API key directly in your browser.
        </p>
      </div>

      <!-- API Key Input -->
      <div class="mb-6">
        <label
          for="apiKeyInput"
          class="block text-sm font-medium text-gray-700 mb-2"
          >Your Gemini API Key</label
        >
        <input
          type="password"
          id="apiKeyInput"
          placeholder="Enter your API key here"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
        />
        <p class="text-xs text-gray-500 mt-1">
          Your key is used only for this session and is not stored.
        </p>
      </div>

      <!-- Prompt Input -->
      <div class="mb-6">
        <label
          for="promptInput"
          class="block text-sm font-medium text-gray-700 mb-2"
          >Enter your Prompt</label
        >
        <textarea
          id="promptInput"
          rows="4"
          placeholder="e.g., Explain quantum computing in simple terms"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
        ></textarea>
      </div>

      <!-- Submit Button -->
      <button
        id="submitBtn"
        class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition flex items-center justify-center"
      >
        <span id="buttonText">Generate Response</span>
        <div id="loadingSpinner" class="loader hidden ml-3"></div>
      </button>

      <!-- Response Area -->
      <div class="mt-8">
        <h2 class="text-xl font-semibold text-gray-800 mb-3">Response</h2>
        <div
          id="responseContainer"
          class="w-full p-4 bg-gray-50 border border-gray-200 rounded-lg min-h-[100px] text-gray-700 whitespace-pre-wrap"
        >
          The AI's answer will appear here...
        </div>
      </div>

      <!-- Error Message Box -->
      <div
        id="errorBox"
        class="hidden mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg"
      >
        <strong class="font-bold">Error:</strong>
        <span id="errorMessage"></span>
      </div>
    </div>

    <script>
      // DOM element references
      const apiKeyInput = document.getElementById("apiKeyInput");
      const promptInput = document.getElementById("promptInput");
      const submitBtn = document.getElementById("submitBtn");
      const responseContainer = document.getElementById("responseContainer");
      const loadingSpinner = document.getElementById("loadingSpinner");
      const buttonText = document.getElementById("buttonText");
      const errorBox = document.getElementById("errorBox");
      const errorMessage = document.getElementById("errorMessage");

      // Function to handle the API call
      async function getGenerativeContent() {
        const apiKey = apiKeyInput.value.trim();
        const prompt = promptInput.value.trim();

        // --- Input Validation ---
        if (!apiKey) {
          showError("Please enter your API key.");
          return;
        }
        if (!prompt) {
          showError("Please enter a prompt.");
          return;
        }

        // --- UI State: Loading ---
        setLoadingState(true);
        hideError();

        try {
          // The API endpoint for the Gemini model. Updated to a valid and more recent model name.
          const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

          // The request payload
          const requestBody = {
            contents: [
              {
                parts: [{ text: prompt }],
              },
            ],
          };

          // Making the API call using fetch
          const response = await fetch(url, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(requestBody),
          });

          // Check if the network response is OK
          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(
              errorData.error.message ||
                `API request failed with status: ${response.status}`
            );
          }

          const data = await response.json();

          // Extract and display the generated text
          if (
            data.candidates &&
            data.candidates.length > 0 &&
            data.candidates[0].content &&
            data.candidates[0].content.parts &&
            data.candidates[0].content.parts.length > 0
          ) {
            const generatedText = data.candidates[0].content.parts[0].text;
            responseContainer.innerText = generatedText;
          } else {
            responseContainer.innerText =
              "No response generated. The API returned an empty result.";
          }
        } catch (error) {
          console.error("Error:", error);
          showError(error.message);
          responseContainer.innerText =
            "An error occurred. Please check the console and the error message above.";
        } finally {
          // --- UI State: Not Loading ---
          setLoadingState(false);
        }
      }

      // --- Helper Functions for UI ---
      function setLoadingState(isLoading) {
        submitBtn.disabled = isLoading;
        if (isLoading) {
          buttonText.innerText = "Generating...";
          loadingSpinner.classList.remove("hidden");
        } else {
          buttonText.innerText = "Generate Response";
          loadingSpinner.classList.add("hidden");
        }
      }

      function showError(message) {
        errorMessage.innerText = message;
        errorBox.classList.remove("hidden");
      }

      function hideError() {
        errorBox.classList.add("hidden");
      }

      // Event listener for the submit button
      submitBtn.addEventListener("click", getGenerativeContent);

      // Allow pressing Enter in the textarea to submit
      promptInput.addEventListener("keydown", (event) => {
        if (event.key === "Enter" && !event.shiftKey) {
          event.preventDefault(); // Prevent new line
          getGenerativeContent();
        }
      });
    </script>
  </body>
</html>
